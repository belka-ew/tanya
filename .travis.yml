sudo: false

os:
  - linux
  - osx

language: d

d:
  - dmd-2.079.0
  - dmd-2.078.3
  - dmd-2.077.1
  - dmd-2.076.1

env: 
  matrix:
    - ARCH=x86_64
    - ARCH=x86

addons:
  apt:
    packages:
      - gcc-multilib

before_script:
  - if [ "$PS1" = '(dmd-2.079.0)' ]; then
      export UNITTEST="unittest-cov";
    fi

script:
  - dub test -b ${UNITTEST:-unittest} --arch=$ARCH --compiler=$DC

after_success:
  - test "$UNITTEST" = "unittest-cov" && bash <(curl -s https://codecov.io/bash)
